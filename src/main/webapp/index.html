<!DOCTYPE html>
<html>
<head>
    <title>Discord Soundboard</title>
    <script src="js/vendor/jquery-2.2.1.js"></script>
    <script src="js/vendor/jquery-ui.min.js"></script>
    <script src="js/resizeselect.js"></script>
    
    <link rel="stylesheet" type="text/css" href="style/soundboard.css">
    <link rel="stylesheet" type="text/css" href="jquery-ui.min.css">
    
    <script type="application/javascript">
        $(document).ready(function() {
            $.ajax({
                url: "/soundsApi/getAvailableSounds",
                success: function( data ) {
                    $(".buttonContainer").empty();
                    $.each(data, function(i, obj) {
                        //use obj.id and obj.name here, for example:
                        $(".buttonContainer").append($("<button></button>")
                                .attr("class", 'soundButton')
                                .attr("id", obj.soundFileId)
                                .attr("value", obj.soundFileId)
                                .attr("data-category", obj.category)
                                .text(obj.soundFileId));
                        $(".buttonContainer").append("<div class='divider'/>");
                    });
                    $("button, input:button").button();

                    $(".soundButton").click(function() {
                        var username = $(".userNameSelect option:selected").text();
                        $.ajax({
                            url: "/soundsApi/playFile?soundFileId=" + this.value + "&username=" + username
                        });
                    });
                }
            });
            
            $.ajax({
                url: "/soundsApi/getUsers",
                success: function(data) {
                    $.each(data, function(i, obj) {
                        $('.userNameSelect')
                            .append($("<option></option>")
                                .attr("value",obj.username)
                                .text(obj.username));
                        if (obj.selected) {
                            $(".userNameSelect option[value='" + obj.username + "']").attr('selected', 'selected');
                        }
                    });
                    $('.userNameSelect').selectmenu({ width : 'auto'});
                }
            });

            $.ajax({
                url: "/soundsApi/getSoundCategories",
                success: function(data) {
                    $.each(data, function(i, obj) {
                        $('.categorySelect')
                                .append($("<option></option>")
                                        .attr("value",obj)
                                        .text(obj));
                    });
                    $('.categorySelect').selectmenu({ width : 'auto'});
                }
            });

            $("#volume").slider({
                min: 0,
                max: 100,
                value: 75,
                range: "min",
                animate: true,
                slide: function(event, ui) {
                    var volume = ui.value;
                    $.ajax({
                        url: "/soundsApi/setVolume?volume=" + volume,
                        method: 'POST'
                    });
                }
            });
            $('.userNameSelect').change(function() {
                $("#width_tmp_option").html($('#userSelect option:selected').text());
                $(this).width($("#width_tmp_select").width());
            });
        });
    </script>
</head>
<body>
    <span class="userNameContainer">
        <label for="userSelect" class="ui-widget">Select the username:</label>
        <select id="userSelect" class="userNameSelect resizeselect">
        </select>
    </span>
    <span class="categoryContainer">
        <label for="categorySelect" class="ui-widget">Select the category:</label>
        <select id="categorySelect" class="categorySelect resizeselect">
        </select>
    </span>
    <div class="buttonContainer"></div>
    
    <div id="player">
		<div id="volume"></div>
	</div>
</body>
</html>